/**
 * @license
 * Copyright (c) 2023 The Nuevodebel Team. All rights reserved.
 * Version 1.0
 */
!function(e,t){"function"==typeof define&&define.amd?define([],t.bind(this,e,e.videojs)):"undefined"!=typeof module&&module.exports?module.exports=t(e,e.videojs):t(e,e.videojs)}(window,function(e,t){"use strict";e.videojs_visualizer={version:"0.2"},t.registerPlugin||t.plugin,t.registerPlugin("visualizer",function(i){this.ready(function(){!function(i,o){var n,r,a,s=i.el(),c=i.$(".vjs-tech"),l=t.obj.merge({video:!1,color1:"#ffcc00",color2:"#ff0000",capsColor:"#fff",caps:!1,bottom:0,height:50,f_play:!1},o||{});if(1==(e.AudioContext=e.AudioContext||e.webkitAudioContext,!!e.AudioContext)&&!t.browser.IS_IPHONE&&!t.browser.IS_IPOD){var d,f,u,h,m,p,v,g,y=!0,w=new WeakMap,A="50",b="0";parseInt(l.height)>0&&parseInt(l.height)<=100&&(A=parseInt(l.height)),parseInt(l.bottom)>0&&(b=parseInt(l.bottom)+"%"),parseInt(l.width)<=100&&parseInt(l.width)>10&&parseInt(l.width),n=".vjs-visualizer{position:absolute;padding:0 10px;bottom:"+b+";width:100%;height:"+A+"%;pointer-events:none;}",r=document.head||document.getElementsByTagName("head")[0],(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=n:a.appendChild(document.createTextNode(n)),r.appendChild(a),(u=document.createElement("canvas")).className="vjs-visualizer",u.id="visualizer",s.insertBefore(u,i.controlBar.el_),i.ready(function(){d=!1,i.on("loadeddata",function(){var e=i.currentType();d=e.indexOf("audio")>-1,l.f_play=!1,l.video&&(d=!0)}),i.on("playing",function(){if(!l.f_play){void 0!==i.currentSource().av&&(y=!1);var t=s.querySelector(".vjs-background-bar");if(l.f_play=!0,d&&y&&t){function o(e,t){e=e.replace("#","");var i=parseInt(3==e.length?e.slice(0,1).repeat(2):e.slice(0,2),16),o=parseInt(3==e.length?e.slice(1,2).repeat(2):e.slice(2,4),16),n=parseInt(3==e.length?e.slice(2,3).repeat(2):e.slice(4,6),16);return t?"rgba("+i+", "+o+", "+n+", "+t+")":"rgb("+i+", "+o+", "+n+")"}!function(){c=i.$(".vjs-tech");try{null==f&&(f=new AudioContext),w.has(c)?v=w.get(c):(v=f.createMediaElementSource(c),w.set(c,v)),g=f.createAnalyser(),u.width=u.offsetWidth,u.height=s.offsetHeight,p=u.getContext("2d"),v.connect(g),g.connect(f.destination)}catch(e){}}(),l.color1.indexOf("#")<0&&(l.color1="#"+l.color1),l.color2.indexOf("#")<0&&(l.color2="#"+l.color2);var n="#ffcc00",r="#ff0000",a="#fff",A=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i;A.test(l.capsColor)&&(a=l.capsColor),A.test(l.color1)&&(n=l.color1),A.test(l.color2)&&(r=l.color2);var b=o(n),I=o(r),x=o(n,.2),C=new Array;function S(){if(d){if("VIDEO"==(c=i.$(".vjs-tech")).nodeName){var t=s.querySelector(".vjs-background-bar");t&&(t.style.height="10%")}g.fftSize=256,h=g.frequencyBinCount,u.width=s.offsetWidth-20;var o=u.width/h*1.2;o<6&&(o=6);var n,r=1;u.width<500&&(r=2),e.RequestAnimationFrame=e.requestAnimationFrame(S)||e.msRequestAnimationFrame(S)||e.mozRequestAnimationFrame(S)||e.webkitRequestAnimationFrame(S);var f=0;m=new Uint8Array(h),g.getByteFrequencyData(m),p.clearRect(0,0,u.width,u.height);for(var v=0;v<h;v+=r)if(v=parseInt(v),n=m[v],f+o<u.width){var y=p.createLinearGradient(0,0,0,.5*u.height);y.addColorStop(1,b),y.addColorStop(.5,I),y.addColorStop(0,I);var w=u.height/1.5-n,A=u.height/1.5;p.fillStyle=y,p.fillRect(f,w,o,n),l.caps&&(C[f]?(p.fillStyle=a,w<C[f]?(C[f]=w,w!=A&&p.fillRect(f,w-6,o,3)):(C[f]=C[f]+1,C[f]<A&&p.fillRect(f,C[f]-6,o,3))):C[f]=w),p.fillStyle=x,p.fillRect(f,u.height/1.5,o,n/2),f+=o+4}}else try{p.clearRect(0,0,u.width,u.height)}catch(e){}}e.RequestAnimationFrame=e.requestAnimationFrame(S)||e.msRequestAnimationFrame(S)||e.mozRequestAnimationFrame(S)||e.webkitRequestAnimationFrame(S)}}})})}}(this,i)})})});